function uuidGenerator(){return{uuidv4:function(){var a=Date.now();if(typeof performance!=="undefined"&&typeof performance.now==="function"){a+=performance.now()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=(a+Math.random()*16)%16|0;a=Math.floor(a/16);return(d==="x"?b:(b&3|8)).toString(16)})}}}var INTERACTION_ID_CNAME="gk-interaction-id";var INTERACTION_ID_EXPIRY=30;var SESSION_ID_CNAME="gk-session-id";var DEVICE_ID_CNAME="gk-device-id";function cookieHelper(){function a(f){var e=f+"=",d=document.cookie.split(";");for(var g=0;g<d.length;g++){var h=d[g];while(h.charAt(0)===" "){h=h.substring(1)}if(h.indexOf(e)===0){return h.substring(e.length,h.length)}}return""}function b(f,h,c){var g=new Date();g.setTime(g.getTime()+(c*60*1000));var e="expires="+g.toUTCString();document.cookie=f+"="+h+";"+e+";path=/"}return{checkInteractionId:function(){var c=a(INTERACTION_ID_CNAME);if(c!==""){b(INTERACTION_ID_CNAME,c,INTERACTION_ID_EXPIRY);return false}else{c=uuidGenerator().uuidv4();b(INTERACTION_ID_CNAME,c,INTERACTION_ID_EXPIRY);return true}},getCookie:function(c){return a(c)}}}document.onclick=function(b){var a=gameskraft.analytics.getClient();a.trackClick(b)};window.onload=function(h){var j=gameskraft.analytics.getClient();var g,f=/\+/g,k=/([^&=]+)=?([^&]*)/g,a=function(e){return decodeURIComponent(e.replace(f," "))},i=window.location.search.substring(1),c;c={};while(g=k.exec(i)){c[a(g[1])]=a(g[2])}var d={};if(c.hasOwnProperty("utm_source")){d.utm_source=c.utm_source}if(c.hasOwnProperty("utm_medium")){d.utm_medium=c.utm_medium}if(c.hasOwnProperty("utm_campaign")){d.utm_campaign=c.utm_campaign}if(c.hasOwnProperty("utm_txn_id")){d.utm_txn_id=c.utm_txn_id}if(c.hasOwnProperty("utm_term")){d.utm_term=c.utm_term}if(c.hasOwnProperty("affiliate_id")){d.affiliate_id=c.affiliate_id}if(c.hasOwnProperty("gclid")){d.gclid=c.gclid}if(c.hasOwnProperty("fbclid")){d.fbclid=c.fbclid}if(!_isEmpty(d)){localStorage.setItem("utmParams",JSON.stringify(d))}c.eventName="pageView";c.pageName=window.location.pathname;var b=cookieHelper().checkInteractionId();if(b){j.trackData({eventName:"interactionStart",id:1})}j.trackData(c)};function _isEmpty(a){for(var b in a){if(a.hasOwnProperty(b)){return false}}return JSON.stringify(a)===JSON.stringify({})}var LOCAL_QUEUE_NAME="GK_LOCAL_QUEUE";var LOCAL_QUEUE_SIZE_NAME="GK_LOCAL_QUEUE_SIZE";var MAX_QUEUE_SIZE=100;var isWriting=false;LocalQueue=function(d){if(!d){return null}var c={};var b=String.fromCharCode(31);function a(f){var g=localStorage.getItem(f);if(!g||g===null){localStorage.setItem(f,"");return""}return g}function e(g){var h=[];if(g&&g!==null){var f=g.split(b);f.forEach(function(j){try{var k=JSON.parse(j);h.push(k)}catch(i){console.error(i)}})}return h}c.push=function(g){var i=this.size();if(i>MAX_QUEUE_SIZE){console.log("threshold reached");return false}try{var h=a(d);if(h===""){h+=JSON.stringify(g)}else{h+=b+JSON.stringify(g)}localStorage.setItem(d,h)}catch(f){console.log(f);return false}return true};c.pushAll=function(k){try{if(Object.prototype.toString.call(k)==="[object Array]"){var m=this.size();if(k.length+m>MAX_QUEUE_SIZE){console.log("threshold reached");return false}var l=a(d);var f="";for(var g=0;g<k.length;g++){var j=k[g];if(f===""){f+=JSON.stringify(j)}else{f+=b+JSON.stringify(j)}}if(l===""){l+=f}else{l+=b+f}localStorage.setItem(d,l)}else{return false}}catch(h){return false}return true};c.pop=function(){try{var i=a(d);var g=i.indexOf(b);if(g>-1){var f=i.substr(0,g);i=i.substr(g+1);localStorage.setItem(d,i);return JSON.parse(f)}else{if(i.length>0){localStorage.setItem(d,"");return JSON.parse(i)}else{return null}}}catch(h){console.log(h);return null}};c.getFront=function(){try{var i=a(d);var g=i.indexOf(b);if(g>-1){var f=i.substr(0,g);return JSON.parse(f)}else{if(i.length>0){return JSON.parse(i)}else{return null}}}catch(h){return null}};c.getBack=function(){try{var h=a(d);var f=h.lastIndexOf(b);if(f>-1){var i=h.substr(f+1);return JSON.parse(i)}else{if(h.length>0){return JSON.parse(h)}else{return null}}}catch(g){return null}};c.getAll=function(){return e(a(d))};c.removeAll=function(){var f=a(d);localStorage.setItem(d,"");return e(f)};c.size=function(){try{var h=a(d);if(h===""){return 0}else{var f=h.split(b);return f.length}}catch(g){return null}};return c};var LOCAL_KEY_QUEUE_NAME="GK_LOCAL_KEY_QUEUE";IndexedQueue=function(){var b=new LocalQueue(LOCAL_KEY_QUEUE_NAME);function c(d){if(d&&d!==null){var e=d.match(/\d*$/);return d.substr(0,e.index)+(++e[0])}else{return"0"}}function a(d){if(d&&d!==null){return d+1}return 0}this.pushIQ=function(e,f){var d=c(b.getBack());if(b.push(d)){localStorage.setItem(d,e)}f()};this.popIQ=function(){var d=b.pop();if(d&&d!==null){var e=localStorage.getItem(d);localStorage.removeItem(d);return e}return null};this.getFrontIQ=function(){var d=b.getFront();if(d&&d!==null){return localStorage.getItem(d)}else{return null}};this.getFrontIQIndex=function(){return b.getFront()};this.getBackIQ=function(){var d=b.getBack();if(d!==null){return localStorage.getItem(d)}else{return null}};this.getAllKeys=function(){return b.getAll()};this.getAll=function(){console.log("inProgress");return[]};this.removeAll=function(){console.log("inProgress");return true}};if(!gameskraft){var gameskraft={}}var syncing=false;gameskraft.syncData={_instance:{syncOne:function(){if(syncing===true){return}syncing=true;var c=new IndexedQueue();var b=c.getFrontIQ();var e=new XMLHttpRequest();e.onreadystatechange=function(){if(this.readyState===4&&this.status===200){clearTimeout(a);c.popIQ();syncing=false}else{if(this.readyState===4&&this.status!==200){clearTimeout(a);syncing=false}}};e.open("POST","//analytics.rummyculture.com/events/click",true);e.send(b);var a=setTimeout(d,30000);function d(){e.abort();syncing=false}},syncAll:function(){if(syncing===true){return}var c=new IndexedQueue();var b=c.getFrontIQ();if(!b||b===null){c.popIQ();setTimeout(gameskraft.syncData.getClient().syncAll,15000);return}syncing=true;var e=new XMLHttpRequest();e.onreadystatechange=function(){if(this.readyState===4&&this.status===200){clearTimeout(a);c.popIQ();syncing=false;setTimeout(gameskraft.syncData.getClient().syncAll,5000)}else{if(this.readyState===4&&this.status!==200){console.log("some error occurred ",this.responseText);clearTimeout(a);syncing=false;setTimeout(gameskraft.syncData.getClient().syncAll,5000)}}};e.open("POST","//analytics.rummyculture.com/events/click",true);e.setRequestHeader("Content-type","text/plain");e.send(b);var a=setTimeout(d,30000);function d(){console.log("timedout");e.abort();syncing=false;setTimeout(gameskraft.syncData.getClient().syncAll,5000)}}},getClient:function(){return this._instance}};if(!gameskraft){var gameskraft={}}gameskraft.analytics={_instance:{trackClick:function(g){var f=cookieHelper().checkInteractionId();if(f){this.trackData({eventName:"interactionStart"})}var b=g.srcElement;var a=b;while(a){if(a.className&&(typeof a.className.indexOf==="function")&&a.className.indexOf("gk-analytics-skip")>=0){return}if(this.isElement(a)&&a.getAttribute("data-gk-id")){b=a;break}a=a.parentNode}if(!a){return}var d={eventName:"clickEvent",className:b.className,baseUri:b.baseURI,elementId:b.id,lang:b.lang,localName:b.localName,nodeName:b.nodeName,tagName:b.tagName,title:b.title,gkId:b.getAttribute("data-gk-id")};d=this.addMetadata(d);var c=new IndexedQueue();c.pushIQ(JSON.stringify(d),this.pushQueueCallback)},trackData:function(b){b=this.addMetadata(b);var a=new IndexedQueue();a.pushIQ(JSON.stringify(b),this.pushQueueCallback)},addMetadata:function(c){c.eventTimeStamp=new Date().getTime();c.eventId=uuidGenerator().uuidv4();c.interactionId=cookieHelper().getCookie(INTERACTION_ID_CNAME);c.deviceId=cookieHelper().getCookie(DEVICE_ID_CNAME);c.sessionId=cookieHelper().getCookie(SESSION_ID_CNAME);c.source="web";if(typeof gkGetLoggedInUserId==="function"){c.userId=gkGetLoggedInUserId()}if(!c.hasOwnProperty("userId")||!c.userId){c.userId="0"}var a=localStorage.getItem("utmParams");var b={};if(a){b=JSON.parse(a)}if(!c.hasOwnProperty("utm_source")&&b&&b.hasOwnProperty("utm_source")){c.utm_source=b.utm_source}if(!c.hasOwnProperty("utm_medium")&&b&&b.hasOwnProperty("utm_medium")){c.utm_medium=b.utm_medium}if(!c.hasOwnProperty("utm_campaign")&&b&&b.hasOwnProperty("utm_campaign")){c.utm_campaign=b.utm_campaign}if(!c.hasOwnProperty("utm_term")&&b&&b.hasOwnProperty("utm_term")){c.utm_term=b.utm_term}if(!c.hasOwnProperty("utm_txn_id")&&b&&b.hasOwnProperty("utm_txn_id")){c.utm_txn_id=b.utm_txn_id}if(!c.hasOwnProperty("affiliate_id")&&b&&b.hasOwnProperty("affiliate_id")){c.affiliate_id=b.affiliate_id}if(!c.hasOwnProperty("gclid")&&b&&b.hasOwnProperty("gclid")){c.gclid=b.gclid}if(!c.hasOwnProperty("fbclid")&&b&&b.hasOwnProperty("fbclid")){c.fbclid=b.fbclid}return c},pushQueueCallback:function(){var a=gameskraft.syncData.getClient();a.syncAll()},isNode:function(a){return(typeof Node==="object"?a instanceof Node:a&&typeof a==="object"&&typeof a.nodeType==="number"&&typeof a.nodeName==="string")},isElement:function(a){return(typeof HTMLElement==="object"?a instanceof HTMLElement:a&&typeof a==="object"&&a!==null&&a.nodeType===1&&typeof a.nodeName==="string")}},getClient:function(){return this._instance}};
